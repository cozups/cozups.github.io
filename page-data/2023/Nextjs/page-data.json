{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023/Nextjs/","result":{"data":{"site":{"siteMetadata":{"title":"cozups-log"}},"markdownRemark":{"id":"1a695a5e-c4c4-54ff-b742-d0fe60ae9b91","excerpt":"Next.js Next.js는 서버 사이트 렌더링, 정적 웹 페이지 생성 등 리액트 기반 웹 애플리케이션 기능들을 가능케 하는 Node.js 위에서 빌드된 오픈 소스 웹 개발 프레임워크이다. Next.js is a React framework that gives you building…","html":"<h1>Next.js</h1>\n<blockquote>\n<p>Next.js는 서버 사이트 렌더링, 정적 웹 페이지 생성 등 리액트 기반 웹 애플리케이션 기능들을 가능케 하는 Node.js 위에서 빌드된 오픈 소스 웹 개발 프레임워크이다.</p>\n</blockquote>\n<p>Next.js is a React <strong>framework</strong> that gives you building blocks to create web applications.</p>\n<blockquote>\n</blockquote>\n<h1>Rendering</h1>\n<p>우선 렌더링에는 세 가지가 있다.</p>\n<ul>\n<li><strong>Client-side rendering(CSR)</strong></li>\n<li>Pre-rendering\n<ul>\n<li><strong>Static-site generation(SSG)</strong>\n<ul>\n<li>getStaticProps</li>\n</ul>\n</li>\n<li><strong>Server-side rendering(SSR)</strong>\n<ul>\n<li>getServerSideProps</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc9e90c1934f8085980628818ee97024/b5a09/next1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRklEQVR42pVSya6DMAzs/39g1RMt9IklYQ+EPdOMpVS06uVZMoHYHs/YXNZ1xTzP6Psebdui6zqM44hlWcQZ//YQ+5Vz4cNaiyzLkCQJ4jiG1hr7vov/Atu2DcdxSJzvH4BMmOyEUitopWCMkaSiKFDXtTT7ZkM1yueyMXPOrAWQkovaoDMW6zILYJ7n4kzmNz0UDcOA5/OJpmk+4sS5yOyaGq110IPzUnbQWHC73URasMBkmiZcr1ekaSr3zjk5BZBdyISWdRv+8gpV3Yn0KLoLi2AEr6pKGPKMokiYBRPJ3KpSWi4aeyBJFeLHQ+4e/mTXYGRCVmxCBVxkYPcBWPrhbl7ZvXJoRz8j00uQWzwb2ZA5fyvGzmBvydziOBjofkM5cF7OF+5vMMoMhWGGLAz3ZxeGHDATCDxP1g/cyjtZ8PyPE+sFIiQHflzD53sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/dc9e90c1934f8085980628818ee97024/f058b/next1.png\"\n        srcset=\"/static/dc9e90c1934f8085980628818ee97024/c26ae/next1.png 158w,\n/static/dc9e90c1934f8085980628818ee97024/6bdcf/next1.png 315w,\n/static/dc9e90c1934f8085980628818ee97024/f058b/next1.png 630w,\n/static/dc9e90c1934f8085980628818ee97024/40601/next1.png 945w,\n/static/dc9e90c1934f8085980628818ee97024/78612/next1.png 1260w,\n/static/dc9e90c1934f8085980628818ee97024/b5a09/next1.png 1360w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>SSG와 SSR은 클라이언트에게 전달되기 전에 데이터를 가져오고, React를 HTML로 변환하는 작업을 수행하기 때문에 pre-rendering이라고 불린다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a5aa94cac7ae680032f20b6b424fecef/b5a09/next2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVR42oVS246FIBDj/3/Pdx9M1Hg5q3gHka6dHE5Yl+xO0oBMrZ2iMsZAa41pmj4Yx1HOjuOAtfYHyI/x7Cu+VJYl6rpGVVUoikLA/b7vScHrugTneaYFX68eXdtgGEYhDsOAtm3FbeyKe/KbppE+ec++MuYW1Av0vMEaOjJY1xXbtgmJLgIoxrXve5mKEzjn5CyIKmsP6M0h/wJmA7jL3y4dUsUPMduu65BlmQiGojA/qOiIgqX2txhweS/NVM3zLM44GnNm7rGgOJSx7gf/bvg/BJdlkfy45nkuGf8SpM1YwP/jkK5CXnF9Rg7BU4gIv0N4jsGLYoYcmUVu6IWLUQyWxBjhlp8gly5SvdD/BsGlC6Vk+qN6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/a5aa94cac7ae680032f20b6b424fecef/f058b/next2.png\"\n        srcset=\"/static/a5aa94cac7ae680032f20b6b424fecef/c26ae/next2.png 158w,\n/static/a5aa94cac7ae680032f20b6b424fecef/6bdcf/next2.png 315w,\n/static/a5aa94cac7ae680032f20b6b424fecef/f058b/next2.png 630w,\n/static/a5aa94cac7ae680032f20b6b424fecef/40601/next2.png 945w,\n/static/a5aa94cac7ae680032f20b6b424fecef/78612/next2.png 1260w,\n/static/a5aa94cac7ae680032f20b6b424fecef/b5a09/next2.png 1360w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>CSR은 initial load가 클라이언트 사이드에서 진행된다. 따라서 빈 HTML 코드에 자바스크립트가 UI를 구성하는 코드를 수행하면서 렌더링이 진행된다.</p>\n<p>Next.js는 렌더링 방식을 페이지마다 다르게 설정할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63a57f983072cc46815d4e0174a4b621/9937c/next3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.84810126582278%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACp0lEQVR42m1US2/TQBDOn+bIlQscEBJ/gQtIICSqAkUcuCAlUZSkUdO4zct5OXYSe/3aXdv5mFl33YKwNJ71zLef57XbkgUgS0BpjSzLIKU0kuc5ioKcD0+hzka00uTPoZQyGCu853w+ozVca/TWZzizFTrtNkajEQaDATqdDlzXbQi3TgJ3mGA6WWIw7GMycdDr9Yx0u12zh0lbcSxwFBniNDcRpmlqxK41RV6WJdIsRRySLckaH2uOLkkSg+OnhTLDs88aH3oSOjlg7wfwfR9xHJuUOTVOk5LG5cs1+pfkkyf4+xonhDBkDWGlUrzrFmjPNXgt4sSQcfgMMoS6QAmN/pcDFoMIqqCMnuBqjI2QnM8vND71yZgc4QcHBEFg0uAI6w11hFdvNrj+Tj4ZIvBrHJP+FaHIU+oykRW6TlHXf7Ppsq5MDRVkQXHSN9sshuvLtWRdp+wcgAn9zd1ifHuL5XKJm5sbjMdj3NL33d2dGamzmAHhGPvNnPxjTKf3cBzH4DzPa6ahlS18SC9CcDhguVhgt9thQZqJZ7OZGZ1c0syFLqTwKM2Dsa9WK4OZz+dmD8+gIUwqher9NYq2i6SUiCNh6se1a9KmCHn4i+lHaK+LlD4SGrf/NiWj7uH1b5Q/7iEqCRFGiKKoOSl1txVUBZSjt9Crn4jzCiIKG9w/hHS8XvxCeTFBVOWITiHCMDSFfozwgbD/CnrxFSKrEIWnBmebZwhjRR365kAONwizGKfjEUcSTufx7woZHXq1vEK+v8ZJpA2Oy8OkTYS8SVcVChJufUW6elgziIvNwnUsWJe1z2Kf4urBpme32WJLsl6vTVdZc/e229rGo8N2113Ao45uCMtdrm0ufW8ex4ZfnJa9tuwVZg++XfNlYEtg7aztZWIJ/wDhPcMAGqQmUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/63a57f983072cc46815d4e0174a4b621/f058b/next3.png\"\n        srcset=\"/static/63a57f983072cc46815d4e0174a4b621/c26ae/next3.png 158w,\n/static/63a57f983072cc46815d4e0174a4b621/6bdcf/next3.png 315w,\n/static/63a57f983072cc46815d4e0174a4b621/f058b/next3.png 630w,\n/static/63a57f983072cc46815d4e0174a4b621/40601/next3.png 945w,\n/static/63a57f983072cc46815d4e0174a4b621/9937c/next3.png 1156w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>Pre-rendering &#x26; data fetching</h1>\n<p>Pre-rendering에는 두 가지가 있다.</p>\n<ul>\n<li>Static Generation</li>\n<li>Server-side Rendering</li>\n</ul>\n<p><strong>언제 무엇을 사용할까?</strong></p>\n<p>You should ask yourself: \"Can I pre-render this page <strong>ahead</strong> of a user's request?\"</p>\n<p>유저의 요청 전에 페이지를 사전 생성할 수 있는가?</p>\n<ul>\n<li>Yes → Static Generation.\n<ul>\n<li>CDN을 사용하여 SSR보다 빠름</li>\n</ul>\n</li>\n<li>No → Server-side Rendering\n<ul>\n<li>자주 변경되는 데이터가 있을 때 사용</li>\n</ul>\n</li>\n</ul>\n<h2>1. SSG</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37a83817676af9340f0f3011528fe735/062c8/next4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVklEQVR42o2SSXLCQAxFff8j5QZZsmCBwRCwzWBj8IzxJPqp0lSIWdBVKvWkr/8lOXEcy36/l8PhIOzx5/NZxnH8yP4vJwgCmc1mslwuZT6fP/fvPn+ynLIslRGWJImyxHueJ4vFQrbbrd4dj0dVEkWRGkSyLJsCdl0n9/tdmqYRwKuqktvtJnmeqxVFYe5q81YZK/S9rms1YieAaZpqRlhZmX3faxJ83w8ytKUMnQEwe0vAkkDZMAyvgDTier3qB1bbtmosUmSrLyn879+QURPBFPaQ4fwEDMNQdrudrNdrcV1XgUli5SB/tfJks/mR1rCCjQWkJBNAKFNsPIUHyBp1ik4nTZJcLtocVADAG6DETBgyLnSTD9SRDwQiG4YE4znDEA87OxFIt4qcd7NkQS+GFQmpMSp831clNiFvlIkRokkvgO8GmawwIxgWjJUNtM0jwd+7BxHIUfJyPVGvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/37a83817676af9340f0f3011528fe735/f058b/next4.png\"\n        srcset=\"/static/37a83817676af9340f0f3011528fe735/c26ae/next4.png 158w,\n/static/37a83817676af9340f0f3011528fe735/6bdcf/next4.png 315w,\n/static/37a83817676af9340f0f3011528fe735/f058b/next4.png 630w,\n/static/37a83817676af9340f0f3011528fe735/40601/next4.png 945w,\n/static/37a83817676af9340f0f3011528fe735/78612/next4.png 1260w,\n/static/37a83817676af9340f0f3011528fe735/062c8/next4.png 1386w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Static Generation</strong>은 빌드 타임에 HTML이 생성되는 방식이다.</p>\n<p>그 후에 사전 생성된 HTML이 요청마다 다시 사용된다.</p>\n<h3>getStaticProps()</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Get external data from the file system, API, DB, etc.</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token operator\">...</span>\n\n  <span class=\"token comment\">// The value of the `props` key will be</span>\n  <span class=\"token comment\">//  passed to the `Home` component</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">props</span><span class=\"token operator\">:</span> <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>build time에 실행된다.</p>\n<p>기본 형태는 위와 같이 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> allPostsData <span class=\"token operator\">=</span> <span class=\"token function\">getSortedPostsData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">props</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      allPostsData<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 예시에서 props 객체 안에 allPostsData를 반환하게 되는데 이 것이 해당 페이지의 prop이 된다.</p>\n<p>따라서 해당 컴포넌트에서 <code class=\"language-text\">props.allPostsData</code>를 통해 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Home</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> allPostsData <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>getStaticProps는 클라이언트 사이드 코드는 실행하지 않고 <strong>서버 사이드 코드만 실행</strong>하기 때문에 직접 데이터베이스를 쿼리하는 등의 코드를 사용할 수 있다.</p>\n<p>그리고 <strong>getStaticProps는 page 안에서만 사용할 수 있다.</strong> (컴포넌트 X)</p>\n<h2>2. SSR</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f47fd1103a7dd74429b8bff5776f2932/062c8/next5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABeUlEQVR42pVS266CQAzc//85o/HJiCgXEQTkflnQOUxNE46JDzYpu+y2M9Nuzf1+R1VVyPMc1+sVaZqCZ1mW4fl84vV64Rcz2+0Wh8MB+/0e3O92O2w2G3FrLX41Q2VURZWPx0OUFUWBMAxxuVxwOp0wz7MEf1PLc70zbduCTjA6Ceq6FgKuBGfpatxP0ySuRP8Uep4nl3Ecw3VdnM9nAWmaRtSSjMa+kpD/x+MRjuNIz7uukwrpJDM8HMdRAKqyRLk4ldEVgJYkiRCwr4xhBVx5TwH8F0CW+Nkf3ZNdyyKBPpLe69r3vYiSksli7Yh+sGgyD22ZYBitJJNVQRjHpK4f0DeLotjBaCcBI9kwDG9AJtGnaUYS+cjTRJi1ZH2Q98PlAlpXBaLAFfUEZJVaieGHKtqlh3XdLL1shY2Jn2PCJLZBerzEc8/Y9RQIIBl835fZi6JIXpsP8GkEYFwQBLjdbjKnnJI1sVFmnS2q/TZjTFzHaex6Dv8A2Qahocf4ufcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/f47fd1103a7dd74429b8bff5776f2932/f058b/next5.png\"\n        srcset=\"/static/f47fd1103a7dd74429b8bff5776f2932/c26ae/next5.png 158w,\n/static/f47fd1103a7dd74429b8bff5776f2932/6bdcf/next5.png 315w,\n/static/f47fd1103a7dd74429b8bff5776f2932/f058b/next5.png 630w,\n/static/f47fd1103a7dd74429b8bff5776f2932/40601/next5.png 945w,\n/static/f47fd1103a7dd74429b8bff5776f2932/78612/next5.png 1260w,\n/static/f47fd1103a7dd74429b8bff5776f2932/062c8/next5.png 1386w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>Server-side Rendering</strong>은 요청마다 HTML을 사전 생성하는 방식이다.</p>\n<h3>getServerSideProps</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getServerSideProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">context</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">props</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// props for your component</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>request time에 실행된다.</p>\n<p>형태는 getStaticProps와 비슷하다.</p>\n<p>서버가 모든 요청에 대해 결과를 계산해야 하고, 추가 구성 없이는 CDN에서 결과를 캐시할 수 없기 때문에 getStaticProps보다 느리다.</p>\n<h1>Routing</h1>\n<h2>1. File-system based routing</h2>\n<p>Next.js는 파일 시스템을 기반으로 한 라우터를 갖는다.</p>\n<p><code class=\"language-text\">pages</code>폴더 안에 있는 파일들은 파일 이름을 기반으로 자동적으로 라우팅된다.</p>\n<ul>\n<li><code class=\"language-text\">pages/index.js</code> → <code class=\"language-text\">/</code></li>\n<li><code class=\"language-text\">pages/blog/index.js</code> → <code class=\"language-text\">/blog</code></li>\n<li><code class=\"language-text\">pages/blog/first-post.js</code> → <code class=\"language-text\">/blog/first-post</code></li>\n<li><code class=\"language-text\">pages/dashboard/settings/username.js</code> → <code class=\"language-text\">/dashboard/settings/username</code></li>\n</ul>\n<h2>2. Dynamic routes</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/63cab8d594488755e9367a63a8947de2/9239a/next6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.81012658227847%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAABs0lEQVR42pWTh4pCQQxF/f/fEiyICvaOvfculuyeC5GHvLeyAyGZTHJTJ3a5XGy1Wtl2uxVfLpe2WCxss9nYer0WIaPDhjs2wXf3u16vFpvNZpbJZKxcLls2m7VUKmWJRMJyuZzuUKFQsHg8rjdk7NHD8/m8KJlM2ng8tpj9nv1+ryieBZyIwQyDWWE7n8/F8XWZI8Dz+WyHw0GEPJlMrFKpWKlUEjWbTd1rtZo1Gg3dCYz96XQSKPwN+Hkej4fR2yAdj0f1yOn1eoW5hgN+HgAplxMFFAlI6vRrt9sJhNJ6vZ7aMJ1O1SsGiY2XGQzyBkR5v98FMBqN5OScvg0GA+t2u5okMm+A4xOa4fP5VESMbrebhgNRrt/hBMYWQkaPHApI45kg5fT7fRFlkuVwOJQ+rL+hgEzWp0cmvhIEIQuXaQlrAqdcfP4E5JBJOp3WD2APkdnDer2uXaxWq9ITGPoKSMNxYhgO1G63NRTaAIjbfi2Zw4rwV4vFov64806nY61WS2v0L0D+JqXhyJDICiA4oOh8XSIBfQUA9ZVxQoejrxHkXxBd6GI7aHDHgjyKPr/iDyHKE7gMv3mXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/63cab8d594488755e9367a63a8947de2/f058b/next6.png\"\n        srcset=\"/static/63cab8d594488755e9367a63a8947de2/c26ae/next6.png 158w,\n/static/63cab8d594488755e9367a63a8947de2/6bdcf/next6.png 315w,\n/static/63cab8d594488755e9367a63a8947de2/f058b/next6.png 630w,\n/static/63cab8d594488755e9367a63a8947de2/40601/next6.png 945w,\n/static/63cab8d594488755e9367a63a8947de2/9239a/next6.png 1246w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>동적 라우트는 파일 이름에 <code class=\"language-text\">[ ]</code> 대괄호를 사용한다.</p>\n<p>ex) pages/posts/[id].js</p>\n<h3>getStaticPaths()</h3>\n<blockquote>\n<p>we need to return a list of <strong>possible values</strong> for <code class=\"language-text\">id</code>.</p>\n</blockquote>\n<ul>\n<li>동적 라우트 경로로 들어갈 값에 대한 리스트를 반환해야한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticPaths</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Return a list of possible value for id</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>development 단계에서 <code class=\"language-text\">getStaticPaths</code>는 모든 요청마다 실행된다.</li>\n<li>production 단계에서 <code class=\"language-text\">getStaticPaths</code>는 빌드할 때만 실행된다.</li>\n</ul>\n<p><strong>Fallback</strong></p>\n<ul>\n<li><code class=\"language-text\">false</code>\n<ul>\n<li><code class=\"language-text\">getStaticPaths</code>에서 반환되지 않은 경로에 대하여 404 page를 내보낸다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">true</code>\n<ul>\n<li><code class=\"language-text\">getStaticPaths</code>에서 반환된 경로는 빌드 시 HTML로 렌더링된다.</li>\n<li>반환되지 않은 경로는 처음엔 404 page가 아닌 Next.js에서 제공하는 “fallback” 버전의 페이지를 내보낸다.</li>\n<li>백그라운드에서 Next.js는 요청된 경로에 대한 페이지를 정적으로 생성하고 있다. 동일한 경로에 대한 다음 요청이 들어온 경우 이 페이지를 내보낸다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">blocking</code>\n<ul>\n<li>새로운 경로에 대한 페이지는 <code class=\"language-text\">getStaticProps</code>를 이용하여 서버사이드 렌더링 되고 캐시된다.</li>\n</ul>\n</li>\n</ul>\n<h3>getStaticProps()</h3>\n<p>데이터를 가져와야 할 때 getStaticProps 함수에서 params 매개변수를 통해 id 값을 추출할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Fetch necessary data for the blog post using params.id</span>\n  <span class=\"token keyword\">const</span> postId <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Catch-all Routes</h3>\n<p>뒤에 붙은 모든 경로를 캐치할 땐 <code class=\"language-text\">...</code>을 대괄호 안에 같이 써준다.</p>\n<p>ex) pages/posts/[…id].js → <code class=\"language-text\">/posts/a</code>, <code class=\"language-text\">/posts/a/b</code>, <code class=\"language-text\">/posts/a/b/c</code></p>\n<p>이 경우, getStaticPaths는 다음과 같은 배열을 반환해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Statically Generates /posts/a/b/c</span>\n      <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>getStaticProps의 params는</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// params.id will be like ['a', 'b', 'c']</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>3. Router</h2>\n<p>Next.js의 router를 사용하고 싶다면 <code class=\"language-text\">useRouter</code> 훅을 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useRouter <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"next/router\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>4. 404 page</h2>\n<p>커스텀 404 페이지를 만들고 싶다면 <code class=\"language-text\">pages/404.js</code>를 생성하면 된다.</p>\n<p>이 페이지는 빌드 타임에 정적으로 생성된다.</p>\n<h1>API Routes</h1>\n<p>API Routes는 Next.js 앱 내에 API 엔드포인트를 생성한다.</p>\n<p><code class=\"language-text\">pages/api</code> 디렉토리에 함수를 작성하여 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// req = HTTP incoming message, res = HTTP server response</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">req</code> - <code class=\"language-text\">http.IncomingMessage</code>의 인스턴스 + 미들웨어</li>\n<li><code class=\"language-text\">res</code> - <code class=\"language-text\">http.ServerResponse</code>의 인스턴스 + helper 함수</li>\n</ul>\n<h2>주의점</h2>\n<ul>\n<li><code class=\"language-text\">getStaticProps</code>나 <code class=\"language-text\">getStaticPaths</code>에서 API Route를 fetch하면 안된다.\n<ul>\n<li>대신 서버 사이드 코드를 그 안에 직접 작성하여 사용한다.</li>\n<li>두 함수는 클라이언트 사이드 코드를 실행하지 않고 JS 번들에도 포함되지 않기 때문이다.</li>\n</ul>\n</li>\n</ul>\n<h2>Dynamic API Routes</h2>\n<p><code class=\"language-text\">pages/api/post/[pid].js</code> 파일이 있다고 했을 때</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pid <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Post: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>req.query를 참조하여 pid 값을 추출할 수 있다.</p>\n<h3>Catch All Dynamic API Routes</h3>\n<p><code class=\"language-text\">pages/api/post/[...slug].js</code> → <code class=\"language-text\">/api/post/a</code>, <code class=\"language-text\">/api/post/a/b</code>, <code class=\"language-text\">/api/post/a/b/c</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> slug <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Post: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>slug<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\", \"</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>slug는 배열이 되므로 이를 이용한다.</p>","frontmatter":{"title":"Next.js","date":"March 22, 2023","description":"Next.js 배우기","tags":["Next.js"]}},"previous":{"fields":{"slug":"/2023/SASS(SCSS)/"},"frontmatter":{"title":"SASS(SCSS)"}},"next":{"fields":{"slug":"/2023/Nextjs-env/"},"frontmatter":{"title":"Next.js에서 환경 변수 사용하기"}}},"pageContext":{"id":"1a695a5e-c4c4-54ff-b742-d0fe60ae9b91","previousPostId":"8654a1fa-7889-5b04-8930-fb1addbbe8ff","nextPostId":"478a9c3c-2b96-5d19-8956-f6bcbded0c1e"}},"staticQueryHashes":["230163734","2841359383"],"slicesMap":{}}
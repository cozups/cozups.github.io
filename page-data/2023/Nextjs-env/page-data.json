{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023/Nextjs-env/","result":{"data":{"site":{"siteMetadata":{"title":"cozups-log"}},"markdownRemark":{"id":"478a9c3c-2b96-5d19-8956-f6bcbded0c1e","excerpt":"Basic Features: Environment Variables | Next.js 서버 사이드 에 환경 변수 작성 server-only secret…","html":"<p><a href=\"https://nextjs.org/docs/basic-features/environment-variables\">Basic Features: Environment Variables | Next.js</a></p>\n<h1>서버 사이드</h1>\n<ul>\n<li><code class=\"language-text\">.env.local</code>에 환경 변수 작성\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">DB_HOST</span> <span class=\"token operator\">=</span> localhost<span class=\"token punctuation\">;</span>\n<span class=\"token constant\">DB_USER</span> <span class=\"token operator\">=</span> myuser<span class=\"token punctuation\">;</span>\n<span class=\"token constant\">DB_PASS</span> <span class=\"token operator\">=</span> mypassword<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// pages/index.js</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getStaticProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> myDB<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">host</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_HOST</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">username</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_USER</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PASS</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<p>server-only secret을 지키기 위해 빌드 타임 때 평가되어 실제로 사용되는 변수만 포함된다.</p>\n<p>따라서 객체 구조 할당을 사용할 수 없다.</p>\n<h1>클라이언트 사이드</h1>\n<ul>\n<li>\n<p>브라우저 단에서 사용할 땐 <code class=\"language-text\">NEXT_PUBLIC_</code> 을 붙일 것</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">NEXT_PUBLIC_ANALYTICS_ID</span> <span class=\"token operator\">=</span> abcdefghijk<span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// pages/index.js</span>\n<span class=\"token keyword\">import</span> setupAnalyticsService <span class=\"token keyword\">from</span> <span class=\"token string\">\"../lib/my-analytics-service\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 'NEXT_PUBLIC_ANALYTICS_ID' can be used here as it's prefixed by 'NEXT_PUBLIC_'.</span>\n<span class=\"token comment\">// It will be transformed at build time to `setupAnalyticsService('abcdefghijk')`.</span>\n<span class=\"token function\">setupAnalyticsService</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NEXT_PUBLIC_ANALYTICS_ID</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">HomePage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HomePage<span class=\"token punctuation\">;</span></code></pre></div>\n<p>아래와 같이 변수를 활용하여 환경 변수에 접근하는 것은 불가함</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// This will NOT be inlined, because it uses a variable</span>\n<span class=\"token keyword\">const</span> varName <span class=\"token operator\">=</span> <span class=\"token string\">\"NEXT_PUBLIC_ANALYTICS_ID\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setupAnalyticsService</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">[</span>varName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// This will NOT be inlined, because it uses a variable</span>\n<span class=\"token keyword\">const</span> env <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">;</span>\n<span class=\"token function\">setupAnalyticsService</span><span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NEXT_PUBLIC_ANALYTICS_ID</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>","frontmatter":{"title":"Next.js에서 환경 변수 사용하기","date":"March 23, 2023","description":" ","tags":["Next.js"]}},"previous":{"fields":{"slug":"/2023/Nextjs/"},"frontmatter":{"title":"Next.js"}},"next":{"fields":{"slug":"/2023/CSR-vs-SSR/"},"frontmatter":{"title":"CSR vs SSR"}}},"pageContext":{"id":"478a9c3c-2b96-5d19-8956-f6bcbded0c1e","previousPostId":"1a695a5e-c4c4-54ff-b742-d0fe60ae9b91","nextPostId":"6d56fec4-561d-562c-8508-8749bef496aa"}},"staticQueryHashes":["230163734","2841359383"],"slicesMap":{}}
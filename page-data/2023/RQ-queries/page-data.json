{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023/RQ-queries/","result":{"data":{"site":{"siteMetadata":{"title":"cozups-log"}},"markdownRemark":{"id":"783f46c9-5c71-56bb-be26-669021eb4b43","excerpt":"1. 병렬 쿼리(Parallel Queries) - 동시에 쿼리하기 React Query에서는 useQuery를 여러 개 쓰는 것 만으로도 병렬적인 쿼리가 가능하다.  Dynamic Parallel Queries…","html":"<h1>1. 병렬 쿼리(Parallel Queries) - 동시에 쿼리하기</h1>\n<p>React Query에서는 useQuery를 여러 개 쓰는 것 만으로도 병렬적인 쿼리가 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@tanstack/react-query\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">\"axios\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchSuperHeroes</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:4000/superheroes\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchFriends</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:4000/friends\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ParallelQueriesPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> superHeroes <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"super-heroes\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">queryFn</span><span class=\"token operator\">:</span> fetchSuperHeroes<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> friends <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"friends\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">queryFn</span><span class=\"token operator\">:</span> fetchFriends<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>ParallelQueries<span class=\"token punctuation\">.</span>page<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3932f04472bcd2f4f33e29e01b847d09/c23ad/rq-2-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.177215189873415%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVR42q2OzRKCIBSFeYwUsZmSf0FzIaJNvv9TnYjRatUmF9/cMxc4H2SOK0JY4G4PmG5BIwdUZw1ayzQVSiZQMA7pAoSdoP0M1U5QNkK5CN2O6I2DSdl2dxDfhnQhQpgArkfYfoEf1py1m3HhPYqqSQKRy8t6I0noNqskl0kmbQBZrYD0EVx2+TCzP2bis/tB8ZUJZc3b9vrJv5A9nOj12MKjOLzwCR15wrXds9vmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/3932f04472bcd2f4f33e29e01b847d09/f058b/rq-2-1.png\"\n        srcset=\"/static/3932f04472bcd2f4f33e29e01b847d09/c26ae/rq-2-1.png 158w,\n/static/3932f04472bcd2f4f33e29e01b847d09/6bdcf/rq-2-1.png 315w,\n/static/3932f04472bcd2f4f33e29e01b847d09/f058b/rq-2-1.png 630w,\n/static/3932f04472bcd2f4f33e29e01b847d09/40601/rq-2-1.png 945w,\n/static/3932f04472bcd2f4f33e29e01b847d09/c23ad/rq-2-1.png 1193w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Dynamic Parallel Queries</h2>\n<p>만약 쿼리를 해야 하는 횟수가 정해진 게 아니라면 동적으로 병렬 쿼리를 해야 한다.</p>\n<p>예를 들어 주어진 id의 개수에 따라 쿼리 횟수가 달라지는 경우가 있다.</p>\n<p>슈퍼히어로 아이디 배열 [1, 3]이 props로 넘어오는 경우 2번의 쿼리를 해야할 것 이다.</p>\n<p>동적으로 쿼리를 해야할 때는 <code class=\"language-text\">useQueries</code>를 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useQueries <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@tanstack/react-query\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">\"axios\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchSuperHero</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">heroId</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://localhost:4000/superheroes/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>heroId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">DynamicParallelPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> heroIds <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> queryResult <span class=\"token operator\">=</span> <span class=\"token function\">useQueries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">queries</span><span class=\"token operator\">:</span> heroIds<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">heroId</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"super-hero\"</span><span class=\"token punctuation\">,</span> heroId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">queryFn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchSuperHero</span><span class=\"token punctuation\">(</span>heroId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>DynamicParallel Page<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>useQueries의 queries 안에 쿼리할 내용들을 배열로서 넘겨주면 된다.</p>\n<p>쿼리할 내용은 useQuery에서 사용했던 포맷대로 바꾸어 주면 된다.</p>\n<p>동적으로 여러 개의 쿼리를 한 내용은 각 쿼리의 결과가 담긴 배열로 반환 된다.</p>\n<p><code class=\"language-text\">useQueries({queries: [쿼리1, 쿼리 2, …]})</code> ⇒ <code class=\"language-text\">[쿼리 결과1, 쿼리 결과2, ...]</code>의 형식이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cd6d150786f23ff80f6de833ab56d782/1790f/rq-2-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.88607594936709%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVR42o2NWw6CMBREuwt5FCS0pS+KKCkgCibuf09j02hC/NGPk5N7M5MhftywzCvs6Q7br2iMR8Uc6FGhrG2wRFpwyHaE0CN0d0VjJ0g7Q5oJxnp02qE9bzDdDWRyA1S7xABXHsrNcJdHKPtQXlCLHillSPMA5Uii2dsch4whK1Uc42oAeaoKPKxL3SMvRQjWkX0pK8RP4mjIkoR+HnzH9/0/L6CZca9GOzPRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/cd6d150786f23ff80f6de833ab56d782/f058b/rq-2-2.png\"\n        srcset=\"/static/cd6d150786f23ff80f6de833ab56d782/c26ae/rq-2-2.png 158w,\n/static/cd6d150786f23ff80f6de833ab56d782/6bdcf/rq-2-2.png 315w,\n/static/cd6d150786f23ff80f6de833ab56d782/f058b/rq-2-2.png 630w,\n/static/cd6d150786f23ff80f6de833ab56d782/40601/rq-2-2.png 945w,\n/static/cd6d150786f23ff80f6de833ab56d782/1790f/rq-2-2.png 1189w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<hr>\n<h1>2. 순차적으로 쿼리하기(Dependent Queries)</h1>\n<p>쿼리한 결과를 바탕으로 또 다른 쿼리를 하기 위해서는 어떻게 해야할까?</p>\n<p>예를 들어, 어떤 유저의 이메일을 바탕으로 그 사람이 가진 채널의 교육과정을 찾고 싶다고 가정하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// db.json</span>\n<span class=\"token property\">\"users\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cozups@test.com\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"channelId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pp\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"channels\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"course\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"React\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Vue\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Angular\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>이 경우,</p>\n<ol>\n<li>유저의 이메일 → 채널 아이디 찾기</li>\n<li>채널 아이디 → 채널의 교육과정</li>\n</ol>\n<p>이렇게 두 번의 쿼리가 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> user <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> email<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">queryFn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchUserByEmail</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> channelId <span class=\"token operator\">=</span> user<span class=\"token operator\">?.</span>data<span class=\"token punctuation\">.</span>channelId<span class=\"token punctuation\">;</span></code></pre></div>\n<p>우선 유저의 이메일을 바탕으로 channelId를 찾는다.</p>\n<p>channelId 변수는 user가 존재할 때만 할당된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> courses <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"courses\"</span><span class=\"token punctuation\">,</span> channelId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">queryFn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchCoursesByChannelId</span><span class=\"token punctuation\">(</span>channelId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">enabled</span><span class=\"token operator\">:</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>channelId<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>enabled 옵션을 이용하여 channelId가 존재할 때만 쿼리하도록 설정한다.</p>\n<p>enabled에 <code class=\"language-text\">!!channelId</code>를 설정하여 channelId가 할당되어 있을 때만 쿼리하도록 설정할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e8fd320742bbb9fa06966fdb83dab91/d5b59/rq-2-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.746835443037973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFElEQVR42pWQ6W7CMBCE8wxVgUKO5iRxsHMTSIigl/r+b/R1E1RV6q/2x3jXs7PjXVvD+EHfX6m6N/JiIK8umOZFcMPUV5QeUGbA6Ja67NFSU7qnOb4S7VvCpJHY4DwrqnbCmqqG1IykqifOOjJ9JphFaSeinPU2YGNHrLYhXlgQxBWurxbTIK5xvBzbUzxufOE6rFvbk5UTRiaLs5bnyAgKaZ5jiZ9U+PEd37wjhkV94SCD2F7Gzk1YPQXk+ohli2AhvVQK6ZL/IP0F4UQza009ytpXQnlo5+zvhkYMt3a8XNay0p8g2s0ukuYTuhxxg0K+JOFh5ZLmDdZ8JFn1D5TsVc358k53+qQ5TGjh/FhzPN34ArlWr0M83IxEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/8e8fd320742bbb9fa06966fdb83dab91/f058b/rq-2-3.png\"\n        srcset=\"/static/8e8fd320742bbb9fa06966fdb83dab91/c26ae/rq-2-3.png 158w,\n/static/8e8fd320742bbb9fa06966fdb83dab91/6bdcf/rq-2-3.png 315w,\n/static/8e8fd320742bbb9fa06966fdb83dab91/f058b/rq-2-3.png 630w,\n/static/8e8fd320742bbb9fa06966fdb83dab91/40601/rq-2-3.png 945w,\n/static/8e8fd320742bbb9fa06966fdb83dab91/78612/rq-2-3.png 1260w,\n/static/8e8fd320742bbb9fa06966fdb83dab91/d5b59/rq-2-3.png 1370w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>channelId가 할당되지 않은 courses 쿼리의 상태가 ‘idle’인 것을 볼 수 있다.</p>\n<hr>\n<h1>3. Initial Query Data</h1>\n<p>UI에 데이터를 렌더링할 때, 새로 쿼리를 할 필요없이 <strong>이전에 쿼리했던 데이터를 사용</strong>할 수 있는 경우가 있다.</p>\n<p>예를 들어, 어떤 데이터 리스트를 쿼리해 온 경우 리스트 아이템 하나에 대한 디테일 페이지를 만들고 싶으면 새로 쿼리할 필요없이 미리 가져온 리스트를 활용하여 렌더링 할 수 있다.</p>\n<p>이런 경우 useQuery의 initialData 옵션을 사용하면 로딩 표시 없이 데이터를 미리 표시할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"super-hero\"</span><span class=\"token punctuation\">,</span> heroId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">queryFn</span><span class=\"token operator\">:</span> fetchSuperHero<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">initialData</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> hero <span class=\"token operator\">=</span> queryClient\n      <span class=\"token punctuation\">.</span><span class=\"token function\">getQueryData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"super-heroes\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token operator\">?.</span>data<span class=\"token operator\">?.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hero</span> <span class=\"token operator\">=></span> hero<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> <span class=\"token operator\">+</span>heroId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hero<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> hero<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 코드는 슈퍼히어로 리스트를 가져온 후에 슈퍼 히어로 한 명에 대한 디테일 페이지 컴포넌트에 렌더링 하기 위해 작성한 코드이다. initialData를 설정하지 않은 경우에는 디테일 페이지에 들어갈 때 로딩 화면을 보게 된다. 그러나 이미 슈퍼히어로 리스트를 가져왔기 때문에 이를 이용하여 디테일 페이지에 미리 렌더링할 수 있다.</p>\n<p><strong>캐시된 데이터를 사용하기 위하여 queryClient를 사용</strong>해야 하므로 <code class=\"language-text\">useQueryClient</code>를 사용한다. 그리고 queryClient에 담긴 쿼리 데이터에 접근하여 필요한 데이터를 뽑아 쓸 수 있다.</p>\n<p><strong>initialData에 담긴 데이터는 서버에서 데이터를 가져오기 전에 사용된다.</strong> 그러므로 기본적으로 initialData를 화면에 보여준 후 서버에서 데이터를 가져오면 가져온 데이터를 다시 UI에 표시한다.</p>\n<hr>\n<h1>4. 페이지네이션</h1>\n<p>페이지네이션 된 데이터를 불러오고 UI에 렌더링하는 것 자체는 간단하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> keepPreviousData<span class=\"token punctuation\">,</span> useQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@tanstack/react-query\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">\"axios\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchColors</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">pageNumber</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://localhost:4000/colors?_limit=2&amp;_page=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pageNumber<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">PaginatedQueriesPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>pageNumber<span class=\"token punctuation\">,</span> setPageNumber<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> isLoading<span class=\"token punctuation\">,</span> isError<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"colors\"</span><span class=\"token punctuation\">,</span> pageNumber<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">queryFn</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchColors</span><span class=\"token punctuation\">(</span>pageNumber<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">placeholderData</span><span class=\"token operator\">:</span> keepPreviousData<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoading<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>data<span class=\"token operator\">?.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">color</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>div key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>\n            <span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> page <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n          disabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>pageNumber <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          prev page\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button\n          onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setPageNumber</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> page <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n          disabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>pageNumber <span class=\"token operator\">===</span> <span class=\"token number\">4</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span>\n          next page\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>난 현재 json server를 쓰고 있는데 json server는 기본적으로 페이지네이션을 제공한다. 따라서 페이지네이션이 가능한 url로부터 데이터를 받아오고 이를 그대로 렌더링 하면 된다.</p>\n<p>그러나 각 페이지마다 이루어지는 쿼리는 별개의 쿼리로 여겨지기 때문에 페이지를 변경할 때마다 새로 쿼리를 실행한다. 그 결과로 로딩 화면과 결과 화면으로 넘어가는 모습을 계속 보게 된다.</p>\n<p>로딩 화면에서 결과 화면으로 넘어가는 화면을 보여주지 않기 위해 <code class=\"language-text\">placeholderData: keepPreviousData</code> 옵션을 사용할 수 있다. keepPreviousData는 react query가 제공하는 함수로, <strong>서버로부터 데이터를 가져오는 와중에 isLoading 플래그를 활성화 시키지 않고 이전에 가져온 데이터를 계속해서 보여주도록 하는 함수</strong>이다.</p>\n<p>initialData와 비슷하게 서버에서 데이터를 가져오기 전에 사용하는 옵션이고, 서버에서 데이터를 가져오면 가져온 데이터를 UI에 보여준다.</p>\n<hr>\n<h1>5. Infinite Queries</h1>\n<p>‘Load More’ 버튼을 눌러서 계속 데이터를 요청하거나 무한 스크롤을 구현할 경우 react query가 제공하는 <code class=\"language-text\">useInfiniteQuery</code>를 이용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Fragment <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">\"axios\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useInfiniteQuery <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@tanstack/react-query\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchColors</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageParam <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">http://localhost:4000/colors?_limit=2&amp;_page=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pageParam<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">InfiniteQueriesPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    data<span class=\"token punctuation\">,</span>\n    isLoading<span class=\"token punctuation\">,</span>\n    isError<span class=\"token punctuation\">,</span>\n    error<span class=\"token punctuation\">,</span>\n    hasNextPage<span class=\"token punctuation\">,</span>\n    fetchNextPage<span class=\"token punctuation\">,</span>\n    isFetching<span class=\"token punctuation\">,</span>\n    isFetchingNextPage<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useInfiniteQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">queryKey</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"colors\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">queryFn</span><span class=\"token operator\">:</span> fetchColors<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">getNextPageParam</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_lastPage<span class=\"token punctuation\">,</span> pages</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> pages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isLoading<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isError<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>data<span class=\"token operator\">?.</span>pages<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">group<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>Fragment key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span>group<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">color</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>h2 key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n              <span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">{</span>color<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Fragment<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button disabled<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>hasNextPage<span class=\"token punctuation\">}</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fetchNextPage<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          Load more\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>isFetching <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isFetchingNextPage <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">\"Fetching...\"</span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>useInfiniteQuery에서 <code class=\"language-text\">data</code>는 object를 반환한다.\n<ul>\n<li><code class=\"language-text\">pages</code>: 각 페이지의 데이터 배열</li>\n<li><code class=\"language-text\">pageParams</code>: 각 페이지를 가져오는 데 필요한 파라미터 배열</li>\n</ul>\n</li>\n<li><code class=\"language-text\">getNextPageParam</code>\n<ul>\n<li>다음 페이지의 데이터를 가져오기 위해 필요한 파라미터를 반환</li>\n<li>마지막 페이지와 모든 페이지의 전체 배열을 파라미터로 받는다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">hasNextPage</code>\n<ul>\n<li><code class=\"language-text\">getNextPageParam</code>이 null이나 undefined를 반환하지 않으면 true</li>\n</ul>\n</li>\n</ul>\n<p>더 많은 프로퍼티들은 공식 페이지에서 참조</p>\n<p><a href=\"https://tanstack.com/query/v5/docs/react/guides/infinite-queries\">Infinite Queries | TanStack Query Docs</a></p>","frontmatter":{"title":"[React Query] Queries - parallel, dependent, paginated, infinite queries","date":"December 11, 2023","description":"Parallel Queries / Dependent Queries / Paginated Queries / Infinte Queries","tags":["React","React Query"]}},"previous":{"fields":{"slug":"/2023/RQ-caching-refetching/"},"frontmatter":{"title":"[React Query] useQuery / 캐싱 / refetching"}},"next":{"fields":{"slug":"/2024/testing-start-testing/"},"frontmatter":{"title":"[React Testing] 테스팅 시작하기"}}},"pageContext":{"id":"783f46c9-5c71-56bb-be26-669021eb4b43","previousPostId":"fbe27f0f-bbf0-5490-9ff7-4745c750f7ed","nextPostId":"777e0d1b-e406-53ca-afb8-70ed9740cc73"}},"staticQueryHashes":["230163734","2841359383"],"slicesMap":{}}
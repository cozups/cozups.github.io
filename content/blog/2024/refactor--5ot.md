---
title: "5ot ÌîÑÎ°úÏ†ùÌä∏ Î¶¨Ìå©ÌÜ†ÎßÅ"
date: "2024-04-28"
description: "5ot ÌîÑÎ°úÏ†ùÌä∏Î•º Îã§Ïãú ÏÇ¥Ìé¥Î≥¥Î©∞ Ï†ÅÏñ¥Î≥¥Îäî Î¶¨Ìå©ÌÜ†ÎßÅ Î°úÍ∑∏"
category: "Projects"
tags: ["Refactoring"]
---

ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ¶¨Ìï† Í≤∏ ÏΩîÎìúÎ•º Îì§Ïó¨Îã§Î≥¥Îãà Î¨∏Ï†úÏ†êÏù¥ ÏÉùÍ∞ÅÎ≥¥Îã§ ÎßéÏù¥ Î∞úÍ≤¨ÎêòÏóàÎã§üí¶

Ïõπ ÌîÑÎ°úÏ†ùÌä∏Î•º Ï≤òÏùå Î∞∞Ïö∞Í∏∞ ÏãúÏûëÌïòÍ≥† ÎÇòÏÑú ÏñºÎßà ÏïàÎêòÏñ¥ ÏßÑÌñâÌïú ÌîÑÎ°úÏ†ùÌä∏Îùº Í∞úÏÑ†Ìï¥Ïïº Ìï† ÏÇ¨Ìï≠Ïù¥ ÎßéÏïòÎã§.

Îî∞ÎùºÏÑú ÌîÑÎ°úÏ†ùÌä∏ ÏΩîÎìúÎ•º Î¶¨Ìå©ÌÜ†ÎßÅÌïòÎ©¥ÏÑú Í∞úÏÑ† ÏÇ¨Ìï≠Îì§ÏùÑ Ï†ïÎ¶¨Ìï¥Î≥¥Î†§Í≥† ÌïúÎã§.

# Í∞úÏÑ†Ï†ê

1. Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÌïòÎìú ÏΩîÎî© ÎêòÏñ¥ÏûàÏùå ‚Üí DBÏóêÏÑú Ïπ¥ÌÖåÍ≥†Î¶¨Î•º Í∞ÄÏ†∏ÏôÄÏÑú Î†åÎçîÎßÅ
2. ÌôàÌéòÏù¥ÏßÄÏóê Ïä¨ÎùºÏù¥Îî© ÎêòÎäî Ïù¥ÎØ∏ÏßÄÎ•º Í∞Å Ïπ¥ÌÖåÍ≥†Î¶¨ Î≥Ñ Ï≤´Î≤àÏß∏ Ï†úÌíà Ïù¥ÎØ∏ÏßÄÎ°ú Î≥ÄÍ≤Ω
3. all Ïπ¥ÌÖåÍ≥†Î¶¨Îäî ÏßÅÏ†ë Îì±Î°ùÌïòÎäî Í≤ÉÎ≥¥Îã§ DBÏóê Îì±Î°ùÎêú ÏÉÅÌíàÏùÑ ÏµúÏã†ÏàúÏúºÎ°ú Í∞ÄÏ†∏ÏôÄÏÑú Î¶¨Ïä§Ìä∏Î•º Í∑∏Î¶¨Îäî Î∞©Î≤ïÏúºÎ°ú Î≥ÄÍ≤Ω
4. Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Î•º ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•Ìï† Í≤É
   - ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÎäî Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÌéòÏù¥ÏßÄÎ•º Îã´ÏùÑ Í≤ΩÏö∞ ÎπÑÏõåÏßÄÍ∏∞ ÎïåÎ¨∏Ïóê Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÎ•º Ïù¥Ïö©ÌïòÎäî Í≤ÉÏù¥ ÏÇ¨Ïö©Ïûê Ï∏°Î©¥ÏóêÏÑú Ìé∏Î¶¨Ìï† Í≤ÉÏúºÎ°ú ÏòàÏÉÅ
5. ÏÇ¨ÏßÑ ÌÅ¥Î¶≠Ïù¥ ÏïÑÎãàÎùº Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶ÑÎèÑ ÌÅ¥Î¶≠ÌïòÏó¨ Ï†úÌíà Î¶¨Ïä§Ìä∏ ÌôîÎ©¥ÏúºÎ°ú Ï†ëÍ∑ºÌï† Ïàò ÏûàÎèÑÎ°ù ÌïòÎäî Í≤ÉÏù¥ ÏßÅÍ¥ÄÏ†ÅÏù¥Í≥† Ìé∏Ìï† ÎìØ
6. Í≥µÌÜµÎêòÎäî Î°úÏßÅÎì§ÏùÑ Î∂ÑÎ¶¨ÌïòÍ≥† Ïã∂Ïùå‚Ä¶ Ïú†ÏßÄÎ≥¥ÏàòÍ∞Ä ÎÑàÎ¨¥ Ïñ¥Î†µÎã§
7. Í≤ÄÏÉâ Í∏∞Îä•Ïóê Î≤ÑÍ∑∏ ÏàòÏ†ï
8. Ïù¥Î≤§Ìä∏ ÏúÑÏûÑ Î°úÏßÅ Í∞ÄÎèÖÏÑ± Í∞úÏÑ†
   - data Ïñ¥Ìä∏Î¶¨Î∑∞Ìä∏ ÏÇ¨Ïö©

# Í∞úÏÑ†ÌïòÍ∏∞

## 1. Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïòÎìú ÏΩîÎî© Í≥†ÏπòÍ∏∞

ÌòÑÏû¨Ïùò ÏΩîÎìúÎäî Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÌïòÎìú ÏΩîÎî©ÌïúÎã§.

Ïù¥ Í≤ΩÏö∞, Ïπ¥ÌÖåÍ≥†Î¶¨Î•º Ï∂îÍ∞ÄÌïòÎ©¥ ÌôîÎ©¥Ïóê Î†åÎçîÎßÅÎêòÏßÄ ÏïäÎäîÎã§.

Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä Í∏∞Îä•Ïù¥ ÏûàÏùåÏóêÎèÑ Î∂àÍµ¨ÌïòÍ≥† Ïù¥Î•º Ï†úÎåÄÎ°ú ÌôúÏö©ÌïòÏßÄ Î™ªÌïòÎäî Í≤ÉÏù¥Îã§.

```js
export const fetchCategories = async () => {
  try {
    const womanCategories = [];
    const result = await Api.get("/category");
    const manCategories = [];

    // ÏÑ±Î≥Ñ ÌïÑÌÑ∞ÎßÅ
    result.forEach(category => {
      category.sex === "w"
        ? womanCategories.push(category)
        : manCategories.push(category);
    });

    sessionStorage.setItem("womanCategories", JSON.stringify(womanCategories));
    sessionStorage.setItem("manCategories", JSON.stringify(manCategories));

    return [womanCategories, manCategories];
  } catch (err) {
    console.error(err.stack);
    alert(`Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌïòÏòÄÏäµÎãàÎã§. ÌôïÏù∏ ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥ Ï£ºÏÑ∏Ïöî: ${err.message}`);
  }
};
```

DBÎ°úÎ∂ÄÌÑ∞ Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏ÏôÄÏÑú ÏÑ±Î≥Ñ Î≥ÑÎ°ú ÎÇòÎàÑÏñ¥ Î∞òÌôòÌïúÎã§.

```js
export async function renderCategories() {
  const slideButtons = [];

  let womanCategories = [];
  let manCategories = [];

  if (
    !sessionStorage.getItem("womanCategories") ||
    !sessionStorage.getItem("manCategories")
  ) {
    [womanCategories, manCategories] = await fetchCategories();
  } else {
    womanCategories = JSON.parse(sessionStorage.getItem("womanCategories"));
    manCategories = JSON.parse(sessionStorage.getItem("manCategories"));
  }

  // ulÏóê ÎèôÏ†ÅÏúºÎ°ú li ÏÉùÏÑ± ÌõÑ ÏÇΩÏûÖ
  const womanUL = document.querySelector(".slide-button-list.woman");
  const manUL = document.querySelector(".slide-button-list.man");

  const womanCategoriesItem = womanCategories.map((cat, index) => {
    const li = document.createElement("li");
    const item = document.createElement("a");
    item.classList.add("slide-button-element");
    item.value = index;
    item.innerHTML = cat.type;
    item.href = `/list/w/${cat.type}`;

    slideButtons.push(item);

    li.append(item);

    return li;
  });

  const manCategoriesItem = manCategories.map((cat, index) => {
    const li = document.createElement("li");
    const item = document.createElement("a");
    item.classList.add("slide-button-element");
    item.value = womanCategories.length + index;
    item.innerHTML = cat.type;
    item.href = `/list/m/${cat.type}`;

    slideButtons.push(item);

    li.append(item);

    return li;
  });

  womanUL.append(...womanCategoriesItem);
  manUL.append(...manCategoriesItem);

  return slideButtons;
}
```

Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ≥¥Î•º ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•ÌïòÏó¨ Îß§Î≤à Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò¨ ÌïÑÏöîÏÑ±ÏùÑ Ï§ÑÏù¥Í≥† ÌÉ≠ÏùÑ Îã´ÏùÑ ÎïåÎßàÎã§ Ï†ïÎ≥¥Î•º ÏßÄÏö∞ÎèÑÎ°ù ÌïúÎã§.

Ïù¥ ÏûëÏóÖÏù¥ ÌïÑÏöîÌïú ÌéòÏù¥ÏßÄÎäî Ìôà Î©îÏù∏ ÌéòÏù¥ÏßÄ, Ï†úÌíà Î¶¨Ïä§Ìä∏ ÌéòÏù¥ÏßÄ, Ï†úÌíà ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ, Í≤ÄÏÉâ ÌéòÏù¥ÏßÄÏù¥ÎØÄÎ°ú Ïù¥Î•º Í∞Å ÌéòÏù¥ÏßÄÏùò jsÌååÏùºÏóê ÎèÑÏûÖÌïúÎã§.

```js
import * as Api from '/api.js';
import { renderCategories } from '/category.js';

const headerMenu = document.querySelectorAll('#navbar a');
const section = document.getElementsByTagName('section')[0];
const pathname = window.location.pathname.split('/');
const sex = pathname[2];
const type = pathname[3];

// Ïπ¥ÌÖåÍ≥†Î¶¨ Î†åÎßÅ
let sideMenus = await renderCategories();

sideMenus.forEach(
  (menu) => menu.innerHTML === type && menu.classList.add('button-active')
);

...
```

## 2. Ïä¨ÎùºÏù¥Îî© Ïù¥ÎØ∏ÏßÄ Î≥ÄÍ≤Ω

```html
<li class="item-photo new">
  <a href="/list/w/new">
    <img
      src="https://static.zara.net/photos///contents/mkt/spots/ss22-north-woman-new/subhome-xmedia-19//w/1039/IMAGE-landscape-f15c96c3-370d-4703-a9af-4a92065f0bfe-default_0.jpg?ts=1652354105595"
      alt=""
    />
  </a>
</li>
```

Ïä¨ÎùºÏù¥Îî© Ïù¥ÎØ∏ÏßÄ ÎòêÌïú ÏúÑÏùò ÌòïÌÉúÎ°ú ÌïòÎìúÏΩîÎî© ÎêòÏñ¥ÏûàÎã§.

Ïù¥ Í≤ΩÏö∞Ïùò Î¨∏Ï†úÏ†êÏùÄ Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÉàÎ°ú Ï∂îÍ∞ÄÌï† Îïå Îî∞Î°ú Ïù¥ÎØ∏ÏßÄÎ•º ÏÇΩÏûÖÌïòÏßÄ ÏïäÍ∏∞ ÎïåÎ¨∏Ïóê ÏÉàÎ°úÏö¥ Ïπ¥ÌÖåÍ≥†Î¶¨Î•º Ï∂îÍ∞ÄÌïòÎ©¥ Í∑∏ Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä Ï∂úÎ†•Ìï† Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏóÜÏúºÎØÄÎ°ú ÏóëÏä§Î∞ïÏä§Í∞Ä Í∑∏Î†§Ïßà Í≤ÉÏù¥Îã§.

Îî∞ÎùºÏÑú Í∞Å Ïπ¥ÌÖåÍ≥†Î¶¨Ïóê Ï†úÌíàÏù¥ 1Í∞ú Ïù¥ÏÉÅ Îì±Î°ùÎêòÏñ¥ ÏûàÎã§Îäî Í∞ÄÏ†ï ÌïòÏóê Ïä¨ÎùºÏù¥Îî© Ïù¥ÎØ∏ÏßÄÎ•º Í∞Å Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò ÏµúÏã† Ï†úÌíà Ïù¥ÎØ∏ÏßÄÎ°ú Î≥ÄÍ≤ΩÌïòÎ†§ ÌïúÎã§.

Ïπ¥ÌÖåÍ≥†Î¶¨ Îç∞Ïù¥ÌÑ∞Ïóê Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞Î•º Ï∂îÍ∞ÄÌïòÍ≥† Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò ÏÉàÎ°úÏö¥ Ï†úÌíàÏù¥ Îì±Î°ùÎêòÎ©¥ Í∑∏ Ï†úÌíàÏùò Ïù¥ÎØ∏ÏßÄ ÎßÅÌÅ¨Î•º Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞Ïóê Ï†ÄÏû•ÌïúÎã§.

- Ïπ¥ÌÖåÍ≥†Î¶¨ Îç∞Ïù¥ÌÑ∞Ïóê Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞ Ï∂îÍ∞Ä
- ÏÉÅÌíà Îì±Î°ù Ïãú Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞ÏóêÎèÑ ÎßÅÌÅ¨ Ï†ÄÏû•
- Ìôà ÌéòÏù¥ÏßÄÏùò Ïä¨ÎùºÏù¥Îìú Ïù¥ÎØ∏ÏßÄ srcÎ•º Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞Î°ú ÏßÄÏ†ï

### 1) Ïπ¥ÌÖåÍ≥†Î¶¨ Îç∞Ïù¥ÌÑ∞Ïóê Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞ Ï∂îÍ∞Ä

```js
const CategorySchema = new Schema(
  {
    sex: {
      type: String,
      required: true,
    },
    type: {
      type: String,
      required: true,
    },
    // Ï∂îÍ∞ÄÎêú Î∂Ñ
    image: {
      type: String,
    },
  },
  {
    collection: "categories",
    timestamps: false,
  }
);
```

```js
await Api.post("/category", { sex, type, image });
```

Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïä§ÌÇ§ÎßàÏóê imageÎ•º Ï∂îÍ∞ÄÌïòÎ©¥ Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÉàÎ°ú Ï∂îÍ∞ÄÌï† Îïå image ÌîÑÎ°úÌçºÌã∞Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å ÎêúÎã§.

### 2) ÏÉÅÌíà Îì±Î°ù Ïãú Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞ÏóêÎèÑ ÎßÅÌÅ¨ Ï†ÄÏû•

```js
productRouter.post(
  "/insertion",
  upload.single("image"),
  loginRequired,
  async (req, res, next) => {
    try {
      console.log(req.file);

      const { product_name, sex, type, price, producer, stock, product_info } =
        req.body;

      const product_image = `/images/${req.file.filename}`; // image Í≤ΩÎ°ú ÎßåÎì§Í∏∞

      const category = { sex, type };

      const new_product = await productService.addItems({
        product_name,
        category,
        product_image,
        price,
        producer,
        stock,
        product_info,
      });

      // Ï∂îÍ∞ÄÎêú Î∂ÄÎ∂Ñ
      await categoryService.setCategory(
        { sex_YetUpdated: sex, type_YetUpdated: type },
        { image: product_image }
      );

      res.status(201).json(new_product);
    } catch (error) {
      next(error);
    }
  }
);
```

Ïù¥ Î∂ÄÎ∂ÑÏùÄ Î∞±ÏóîÎìú ÏΩîÎìúÎ•º ÏàòÏ†ïÌï¥Ïïº ÌïòÎäî Î∂ÄÎ∂ÑÏù∏Îç∞, ÏÉÅÌíàÏùÑ Îì±Î°ùÌï† Îïå Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò image ÌîÑÎ°úÌçºÌã∞Ïùò Í∞íÏùÑ ÏóÖÎç∞Ïù¥Ìä∏ ÌïòÎèÑÎ°ù ÌñàÎã§.

### 3) Ìôà ÌéòÏù¥ÏßÄÏùò Ïä¨ÎùºÏù¥Îìú Ïù¥ÎØ∏ÏßÄ srcÎ•º Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Ïù¥ÎØ∏ÏßÄ ÌîÑÎ°úÌçºÌã∞Î°ú ÏßÄÏ†ï

```js
function renderSlideImages() {
  const womanCategories = JSON.parse(sessionStorage.getItem("womanCategories"));
  const manCategories = JSON.parse(sessionStorage.getItem("manCategories"));
  const categories = [...womanCategories, ...manCategories];

  const categoryItems = categories.map(
    category => `
    <li class="item-photo ${category.type}">
      <a href="/list/${category.sex}/${category.type}">
        <img
          src="${category.image}"
          alt=""
        />
      </a>
    </li>
  `
  );

  slides.innerHTML = categoryItems.join("");
}
```

ÌïòÎìú ÏΩîÎî©Îêú htmlÏùÑ ÏßÄÏö∞Í≥† ÎèôÏ†ÅÏúºÎ°ú listitemÏùÑ Î†åÎçîÎßÅÌïúÎã§.

## 3. all Ïπ¥ÌÖåÍ≥†Î¶¨ Î¶¨Ïä§Ìä∏ Î≥ÄÍ≤ΩÌïòÍ∏∞

```js
const pathname = window.location.pathname.split("/");
const sex = pathname[2];
const type = pathname[3];

if (type === "all") {
  getProductAll();
} else {
  getProductList();
}
```

```js
async function getProductAll() {
  try {
    const result = await Api.get("/product/all");

    const elements = result.map(data => {
      if (data.category.sex === sex) {
        const { product_name, price, product_info, product_image, product_id } =
          data;

        return `
          <div id="product-list-wrap">
            <a href="/list/${sex}/${data.category.type}/${product_id}"> 
              <div class="product-list">
              <img class="product-thumbnail" src="${product_image}"/>
                <div class="product-content">
                  <div class="content">
                    <h3 class="name">${product_name}</h3>
                    <h4 class="price">${price.toLocaleString()}Ïõê</h4>
                    <p class="description">${product_info}</p>
                  </div>          
                </div>
              </div>
            </a>
            
          </div>
          `;
      }
    });
    console.log(elements);
    section.innerHTML = elements.join("");
  } catch (error) {
    console.log(`error : ${error}`);
  }
}
```

all Ïπ¥ÌÖåÍ≥†Î¶¨Ïóê Ï†ëÍ∑ºÌïòÎ©¥ `getProductAll` Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïúÎã§.

getProductAllÏùÄ Î™®Îì† Ï†úÌíàÏùÑ Î∂àÎü¨ÏôÄ Ìï¥Îãπ ÏÑ±Î≥ÑÏóê ÎßûÍ≤å Ï†úÌíàÏùÑ ÌïÑÌÑ∞ÎßÅÌïòÍ≥† Î†åÎçîÎßÅÌïúÎã§.

ÏÑ±Î≥Ñ Î≥ÑÎ°ú Îç∞Ïù¥ÌÑ∞Î•º ÏøºÎ¶¨ÌïòÎ©¥ ÎêòÏßÄÎßå ÌòÑÏû¨ ÏΩîÎìú ÏÉÅÌÉúÎ°úÎäî Î∞±ÏóîÎìúÏóêÏÑú ÏÑ±Î≥Ñ Î≥ÑÎ°ú Îç∞Ïù¥ÌÑ∞Î•º Í≤ÄÏÉâÌïòÎäî Í∏∞Îä•Ïù¥ ÏóÜÍ∏∞ ÎïåÎ¨∏Ïóê ÏùºÎã® Ïù¥Ï≤òÎüº Íµ¨ÌòÑÌñàÎã§.

## 4. Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥ Ï†ÄÏû• Î∞©Ïãù Î≥ÄÍ≤Ω

ÌòÑÏû¨ Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Î•º ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•ÌïòÍ≥† ÏûàÎã§.

Í∑∏Îü¨ÎÇò Ïù¥ Í≤ΩÏö∞ Ïú†Ï†ÄÍ∞Ä ÌÉ≠ÏùÑ Îã´ÏúºÎ©¥ Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Í∞Ä ÏÇ¨ÎùºÏ†∏ Îã§Ïãú ÌéòÏù¥ÏßÄÏóê Ï†ëÏÜçÌïòÎäî Í≤ΩÏö∞ Îã§Ïãú Î°úÍ∑∏Ïù∏ÏùÑ Ìï¥Ïïº ÌïúÎã§.

Ïù¥ Îã®Ï†êÏùÑ Î≥¥ÏôÑÌïòÍ∏∞ ÏúÑÌï¥ ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóê Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Î•º Ï†ÄÏû•ÌïòÎäî Í≤ÉÏùÑ Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•ÌïòÎäî Î∞©ÏãùÏúºÎ°ú Î∞îÍø®Îã§.

```js
async function handleSubmit(e) {
  e.preventDefault();

  const email = emailInput.value;
  const password = passwordInput.value;

  // Ïûò ÏûÖÎ†•ÌñàÎäîÏßÄ ÌôïÏù∏
  const isEmailValid = validateEmail(email);
  const isPasswordValid = password.length >= 4;

  if (!isEmailValid || !isPasswordValid) {
    return alert(
      "ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä 4Í∏ÄÏûê Ïù¥ÏÉÅÏù∏ÏßÄ, Ïù¥Î©îÏùº ÌòïÌÉúÍ∞Ä ÎßûÎäîÏßÄ ÌôïÏù∏Ìï¥ Ï£ºÏÑ∏Ïöî."
    );
  }

  // Î°úÍ∑∏Ïù∏ api ÏöîÏ≤≠
  try {
    const data = { email, password };

    const result = await Api.post("/api/login", data);
    const token = result.token;

    // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ
    localStorage.setItem("token", token);
    localStorage.setItem("email", email);

    alert(`Ï†ïÏÉÅÏ†ÅÏúºÎ°ú Î°úÍ∑∏Ïù∏ÎêòÏóàÏäµÎãàÎã§.`);

    // Í∏∞Î≥∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
    window.location.href = "/";
  } catch (err) {
    console.error(err.stack);
    alert(`Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌïòÏòÄÏäµÎãàÎã§. ÌôïÏù∏ ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥ Ï£ºÏÑ∏Ïöî: ${err.message}`);
  }
}
```

## 5. Í≤ÄÏÉâ Í∏∞Îä• Í∞úÏÑ†

ÌòÑÏû¨Ïùò Í≤ÄÏÉâ Í∏∞Îä•ÏùÄ

- ÏóîÌÑ∞ ÌÇ§Î•º ÏûÖÎ†•ÌïòÏó¨ Í≤ÄÏÉâ Î∂àÍ∞Ä
- Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä Ï†úÎåÄÎ°ú Î†åÎçîÎßÅ ÎêòÏßÄ ÏïäÏùå

ÏúÑÏùò Î¨∏Ï†úÏ†êÏù¥ ÏûàÎã§.

### 1) ÏóîÌÑ∞ ÌÇ§Î•º ÏûÖÎ†•ÌïòÏó¨ Í≤ÄÏÉâ

```html
<div class="div-container">
  <div class="searchbar">
    <h1 class="search-form-title">ÏÉÅÌíà Í≤ÄÏÉâ</h1>
    <form class="search-form">
      <input
        type="text"
        id="search"
        placeholder="Ï∞æÏúºÏãúÎäî Ï†úÌíàÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
      />
      <button type="button" id="submit">Í≤ÄÏÉâ</button>
    </form>
  </div>
</div>
```

```js
const searchForm = document.querySelector(".search-form");

searchForm.addEventListener("submit", searchProducts);
```

form ÌÉúÍ∑∏Î•º Ï∂îÍ∞ÄÌïòÍ≥† submit Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑàÎ•º Ï∂îÍ∞ÄÌï¥Ï§¨Îã§.

### 2) Í≤ÄÏÉâ Í≤∞Í≥º Î≤ÑÍ∑∏ ÏàòÏ†ï

```js
// Í∏∞Ï°¥ ÏΩîÎìú
async function searchProducts() {
  const input = search.value;
  const result = await Api.get("/product/all");
  const data = [];

  for (let i = 0; i < result.length; i++) {
    const name = result[i].product_name.trim();
    if (name.indexOf(input.replace(/ /g, "").toUpperCase()) !== -1) {
      data.push(result[i]);
    }
  }

  //ÏÑ∏ÏÖòÏä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
  sessionStorage.setItem("searchProducts", JSON.stringify(data));
  window.location.href = "/searchlist";
}
```

```js
// Í∞úÏÑ† ÏΩîÎìú
async function searchProducts(e) {
  e.preventDefault();

  const input = search.value;
  const result = await Api.get("/product/all");
  const data = result.filter(item => {
    return item.product_name
      .trim()
      .toLowerCase()
      .includes(input.toLowerCase().trim());
  });

  //ÏÑ∏ÏÖòÏä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
  sessionStorage.setItem("searchProducts", JSON.stringify(data));
  window.location.href = "/searchlist";
}
```

submit Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑàÎ°ú searchProducts Ìï®ÏàòÎ•º ÏßÄÏ†ïÌïòÏòÄÏúºÎØÄÎ°ú `preventDefault`Ìï®ÏàòÎ°ú ÏÉàÎ°úÍ≥†Ïπ®ÏùÑ Î∞©ÏßÄÌïòÏòÄÎã§.

Í∑∏ Ïù¥ÌõÑÏóê Î™®Îì† Ï†úÌíàÏùò Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§Í≥† Îç∞Ïù¥ÌÑ∞ Ï†úÌíàÎ™ÖÏùÑ ÏÜåÎ¨∏ÏûêÌôî ÌõÑ Í≤ÄÏÉâ ÌÇ§ÏõåÎìúÎ•º Ìè¨Ìï®ÌïòÎäî Í≤ΩÏö∞, Ìï¥Îãπ Îç∞Ïù¥ÌÑ∞Î•º Î∞∞Ïó¥Ïóê Ï†ÄÏû•ÌïúÎã§. Í∏∞Ï°¥Ïùò ÏΩîÎìúÏôÄ Í∏∞Îä•ÏùÄ ÎèôÏùºÌïòÏßÄÎßå filter Ìï®ÏàòÎ•º Ïù¥Ïö©ÌïòÏó¨ Îçî Í∞ÄÎèÖÏÑ± ÏûàÎäî ÏΩîÎìúÎ°ú Î∞îÍæ∏ÏóàÎã§.

searchlist ÌéòÏù¥ÏßÄÏóê Í≤ÄÏÉâ Í≤∞Í≥ºÎ•º ÏÇ¨Ïö©ÌïòÍ∏∞ ÏúÑÌï¥ ÏÑ∏ÏÖò Ïä§ÌÜ†Î¶¨ÏßÄÏóê Îç∞Ïù¥ÌÑ∞Î•º Ï†ÄÏû•ÌïòÏó¨ ÌôúÏö©ÌïòÏòÄÎã§.

# 6. Ïù¥Î≤§Ìä∏ ÏúÑÏûÑ Ïãú Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ Ï≤òÎ¶¨ Î∞©Ïãù Î≥ÄÍ≤Ω

Î¶¨Ïä§Ìä∏Ïùò `li`ÏóòÎ¶¨Î®ºÌä∏ÎßàÎã§ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨Î•º Î∂ÄÏ∞©Ìï¥Ïïº Ìï† ÌïÑÏöîÍ∞Ä ÏûàÏóàÎäîÎç∞, Ïù¥Î•º ÏúÑÌï¥ÏÑú Ïù¥Î≤§Ìä∏ ÏúÑÏûÑÏùÑ Ïù¥Ïö©ÌïòÏó¨ Î∂ÄÎ™® ÏóòÎ¶¨Î®ºÌä∏Ïóê Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ 1Í∞úÎ•º Î∂ÄÏ∞©ÌïòÏó¨ Íµ¨ÌòÑÌñàÎã§.

Í∏∞Ï°¥ ÏΩîÎìúÏóêÏÑúÎäî

```js
function cartRendering() {
  let i = 0;
  cartList.innerHTML = "";

  cartCountField.innerText = `${cart.length}Í∞ú ÏÉÅÌíà`;

  const elements = cart.map(item => {
    const { product_image, product_name, quantity, price } = item;
    const total = price * quantity;
    return `
      <li>
          <input type="checkbox" class="list-checkbox" value="${i}"/>
          <img
            src="${product_image}"
            alt=""
          />
          <div class="cart-item-info">
            <h3>${product_name}</h3>
            <div class="item-quantity">
              <button class="minus" value="${i}">
                <i class="fas fa-minus"></i>
              </button>
              <span class="qty">${quantity}</span>
              <button class="plus" value="${i}"><i class="fas fa-plus"></i></button>
            </div>
            <span class="item-price">${price}</span>
            <span class="item-total-price">Ï¥ù ${total}Ïõê</span>
            <button class='cancel' value="${i++}"><i class="fa-solid fa-trash-can"></i></buttonc>
          </div>
      </li>`;
  });
  cartList.innerHTML = elements.join("");

  setOrderInfo();
  cartList.addEventListener("click", clickHandler);
}
```

`i` Î≥ÄÏàòÎ•º Ïù¥Ïö©ÌïòÏó¨ Î¶¨Ïä§Ìä∏Î•º Î†åÎçîÎßÅ ÌñàÎã§. Í∑∏Î†áÍ≤å ÌñàÎçò Ïù¥Ïú†Îäî ÏöîÏÜåÎ•º ÎàåÎ†ÄÏùÑ Îïå Í∑∏ ÏöîÏÜåÍ∞Ä Ïñ¥Îñ§(Î™á Î≤àÏß∏) ÏöîÏÜåÏù∏ÏßÄ ÏïåÏïÑÎÇ¥Ïïº ÌñàÍ∏∞ ÎïåÎ¨∏Ïù¥ÏóàÎã§. ÎãπÏãú ÎÇ¥Í∞Ä ÏïÑÎäî ÏßÄÏãùÏúºÎ°ú ÏÉùÍ∞ÅÌï¥ÎÇº Ïàò ÏûàÎäî ÏµúÏÑ†Ïùò Î∞©Î≤ïÏù¥ÏóàÍ∏∞ ÎïåÎ¨∏Ïóê Ïù¥Î†áÍ≤å Íµ¨ÌòÑÌñàÎã§.

Í∑∏Îü¨ÎÇò Î¶¨Ìå©ÌÜ†ÎßÅÏùÑ ÏßÑÌñâÌïòÎ©¥ÏÑú data Ïñ¥Ìä∏Î¶¨Î∑∞Ìä∏Ïóê ÎåÄÌï¥ ÏïåÍ≤å ÎêòÏóàÎã§. `data-`Î•º Î∂ôÏó¨ ÏÇ¨Ïö©ÏûêÍ∞Ä Ïª§Ïä§ÌÖÄ Ïñ¥Ìä∏Î¶¨Î∑∞Ìä∏Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎã§.

```js
function cartRendering() {
  cartList.innerHTML = "";

  cartCountField.innerText = `${cart.length}Í∞ú ÏÉÅÌíà`;

  const elements = cart.map(item => {
    const { product_image, product_name, quantity, price, product_id } = item;
    const total = price * quantity;
    return `
      <li data-product-id="${product_id}">
          <input type="checkbox" class="list-checkbox" data-product-id="${product_id}"/>
          <img
            src="${product_image}"
          />
          <div class="cart-item-info">
            <h3>${product_name}</h3>
            <div class="item-quantity">
              <button class="minus" data-product-id="${product_id}">
                <i class="fas fa-minus"></i>
              </button>
              <span class="qty">${quantity}</span>
              <button class="plus" data-product-id="${product_id}">
                <i class="fas fa-plus"></i>
              </button>
            </div>
            <span class="item-price">${price}</span>
            <span class="item-total-price">Ï¥ù ${total}Ïõê</span>
            <button class='cancel' data-product-id="${product_id}"><i class="fa-solid fa-trash-can"></i></buttonc>
          </div>
      </li>`;
  });
  cartList.innerHTML = elements.join("");

  setOrderInfo();
  cartList.addEventListener("click", clickHandler);
}
```

`data-product-id`Î•º Ïù¥Ïö©ÌïòÏó¨ Ìï¥Îãπ ÏöîÏÜåÍ∞Ä Ïñ¥Îñ§ ÏöîÏÜåÏù∏ÏßÄ Ï∞æÍ∏∞Î°ú ÌïúÎã§.

```js
function changeQuantity(type, product_id) {
  const quantityField = document.querySelector(
    `li[data-product-id="${product_id}"] span.qty`
  );
  const totalPriceField = document.querySelector(
    `li[data-product-id="${product_id}"] span.item-total-price`
  );

  const itemIdx = cart.findIndex(item => item.product_id === product_id);
  const item = cart[itemIdx];

  let quantity = +quantityField.innerText;
  const price = item.price;

  switch (type) {
    case "minus":
      if (quantity > 1) {
        quantity--;
      }
      break;
    case "plus":
      quantity++;
      break;
    default:
      break;
  }

  item.quantity = quantity;
  cart.splice(itemIdx, 1, item);

  quantityField.innerText = quantity;
  totalPriceField.innerText = `Ï¥ù ${quantity * price}Ïõê`;

  localStorage.setItem("myCart", JSON.stringify(cart));
  setOrderInfo();
}
```

`document.querySelector`Î•º Ïù¥Ïö©ÌïòÏó¨ data Ïñ¥Ìä∏Î¶¨Î∑∞Ìä∏Î•º Í∏∞Ï§ÄÏúºÎ°ú ÏöîÏÜåÎ•º Ï∞æÏùÑ Ïàò ÏûàÎã§. Ïù∏Îç±Ïä§Î•º Ïù¥Ïö©ÌïòÏó¨ ÏöîÏÜåÎ•º Ï∞æÎäî Í≤ÉÎ≥¥Îã§ ÏâΩÍ≤å ÏΩîÎìúÎ•º ÏûëÏÑ±Ìï† Ïàò ÏûàÎã§.

Ïù¥Îü¨Ìïú Î∞©ÏãùÏúºÎ°ú Ïù¥Î≤§Ìä∏ ÏúÑÏûÑ Î∞©ÏãùÏù¥ ÌïÑÏöîÌïú Î∂ÄÎ∂ÑÏùÄ Î™®Îëê data Ïñ¥Ìä∏Î¶¨Î∑∞Ìä∏Î•º ÏÇ¨Ïö©ÌïòÏòÄÎã§.

[cart ÏΩîÎìú](https://github.com/cozups/5ot/blob/master/src/views/cart/cart.js)

[review ÏΩîÎìú](https://github.com/cozups/5ot/blob/master/src/views/product-detail/review.js)

[Ïπ¥ÌÖåÍ≥†Î¶¨ Í¥ÄÎ¶¨ ÏΩîÎìú](https://github.com/cozups/5ot/blob/master/src/views/manage-category/manage-category.js)

[Ï†úÌíà Í¥ÄÎ¶¨ ÏΩîÎìú](https://github.com/cozups/5ot/blob/master/src/views/manage-product/manage-product.js)

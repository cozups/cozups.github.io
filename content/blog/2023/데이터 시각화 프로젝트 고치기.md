---
title: "ë°ì´í„° ì‹œê°í™” í”„ë¡œì íŠ¸ ê³ ì¹˜ê¸°"
date: "2023-04-09"
description: "ê°œì¸ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ - ë°ì´í„° ì‹œê°í™” í”„ë¡œì íŠ¸ ì°¨ê·¼ì°¨ê·¼ ê°œì„ í•˜ê¸°"
category: "Projects"
tags: ["Refactoring"]
---

ì½”ë“œë¦¬ë·°ëŠ” ChatGPTì˜ ë„ì›€ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.

í”„ë¡œì íŠ¸ repository: https://github.com/LifeIsAlone/DataVisualize

ì›ê¸€: [ë…¸ì…˜](https://www.notion.so/cc31cadf9cab47e4b37e098a6a8a677b?pvs=21)

# ê°œì„ í•  ì‚¬í•­ë“¤

- [x] csv íŒŒì¼ ë¦¬ë”© ì½”ë“œ ê³ ì¹˜ê¸°
- [x] ë°ì´í„° í‚¤(ì–´íŠ¸ë¦¬ë·°íŠ¸) í† ê¸€ ë°©ì‹ ë°”ê¾¸ê¸°
  - í˜„ì¬ arrayì˜ ë§ˆì§€ë§‰ì— ë„£ê³  ìˆìŒ â†’ ë°ì´í„°ë¥¼ ë„£ì—ˆë‹¤ ë¹¼ë©´ ìƒ‰ê¹”ì´ ë‹¬ë¼ì ¸ì„œ ì°¨íŠ¸ë¥¼ ë³¼ ë•Œ í—·ê°ˆë¦°ë‹¤.
  - ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ìš©í•´ì„œ `isShown: false` ì™€ ê°™ì€ boolean í”„ë¡œí¼í‹°ë¥¼ ë„£ì–´ì„œ ê³ ì³ë³¼ ìƒê°
- [x] ì»¬ëŸ¬ ì…‹ ê°œìˆ˜ê°€ ì ì„ ìˆ˜ë„ ìˆê² ë‹¤ëŠ” ìƒê°ì´ ë“¦
- [x] ìº¡ì³í•´ì„œ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€í•˜ê¸°
- [x] ë°˜ì‘í˜•ìœ¼ë¡œ ë°”ê¾¸ê¸°
- [x] ì¤‘ê°„ì— ë‹¤ë¥¸ íŒŒì¼ ë„£ì—ˆì„ ë•Œ ì œëŒ€ë¡œ ì‘ë™í•˜ê²Œ í•˜ê¸° â†’ ì „ì—­ ìƒíƒœ
- [ ] ì°¨íŠ¸ ì¢…ë¥˜ ëŠ˜ë¦¬ê¸°
- [ ] ë°ì´í„° ì–‘ì‹ ë¬¸ì œì— ëŒ€í•œ ê³ ë¯¼â€¦

# ë¦¬íŒ©í† ë§

## 23.04.09

### 1. Context API ë„ì…

```jsx
import { createContext, useState } from "react";

export const ChartContext = createContext({
  input: [],
  setInput: data => {},
});

const ChartProvider = ({ children }) => {
  const [input, setInput] = useState([]);

  const saveInput = data => {
    setInput(data);
  };

  const chartContext = {
    input,
    setInput: saveInput,
  };

  return (
    <ChartContext.Provider value={chartContext}>
      {children}
    </ChartContext.Provider>
  );
};

export default ChartProvider;
```

ì…ë ¥ ë°›ì€ CSV íŒŒì¼ì´ ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì— ì˜í–¥ì„ ë¯¸ì¹˜ê¸° ë•Œë¬¸ì— ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬í•˜ì˜€ë‹¤.

### 2. ë°ì´í„° í‚¤(ì–´íŠ¸ë¦¬ë·°íŠ¸) í† ê¸€ ë°©ì‹ & í‚¤ ìƒíƒœ êµ¬ì¡° ë°”ê¾¸ê¸°

ê¸°ì¡´ì˜ ì½”ë“œëŠ” ì´ëŸ¬í–ˆë‹¤.

```jsx
const handleKeys = index => {
  if (isActive(index)) {
    const newKeys = activeKeys.filter(item => item !== chartKeys[index]);
    setActiveKeys(newKeys);
  } else {
    setActiveKeys([...activeKeys, chartKeys[index]]);
  }
};
```

ì´ ì½”ë“œì˜ ë¬¸ì œì ì€ í‚¤ë¥¼ on í–ˆë‹¤ê°€ offí•˜ê³  ë‹¤ì‹œ oní•˜ë©´ ë§¨ ëì— ì¶”ê°€ë˜ë¯€ë¡œ ë³´ê¸° í—·ê°ˆë ¤ì§„ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ [ì‚¬ê³¼], [ë°”ë‚˜ë‚˜], [í‚¤ìœ„] ì¤‘ [ì‚¬ê³¼], [í‚¤ìœ„]ë¥¼ ì„ íƒí–ˆë‹¤ê°€ [ì‚¬ê³¼]ë¥¼ ë‹¤ì‹œ ëˆŒëŸ¬ í•´ì œí•˜ë©´ [í‚¤ìœ„]ë§Œ ì„ íƒë˜ëŠ”ë° ì—¬ê¸°ì„œ ë‹¤ì‹œ [ì‚¬ê³¼]ë¥¼ ì„ íƒí•˜ë©´ [í‚¤ìœ„, ì‚¬ê³¼]ê°€ ë˜ë©´ì„œ ì°¨íŠ¸ë¥¼ ë³´ëŠ” ë° í—·ê°ˆë ¤ì§„ë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ í‚¤ì˜ ìƒíƒœ êµ¬ì¡°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë°”ê¾¸ì—ˆë‹¤.

```jsx
{
    name: chartKey,
    activated: false,
    color: randomColorGenerator(),  // ëœë¤ ì»¬ëŸ¬ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
}
```

í‚¤ë¥¼ í† ê¸€ ì‹œ

```jsx
const handleKeys = index => {
  const newChartData = [...chartData];
  newChartData[index] = {
    ...newChartData[index],
    activated: !newChartData[index].activated,
  };
  const newActivatedKeys = newChartData.filter(chartKey => chartKey.activated);
  setChartData(newChartData);
  setActiveKeys(newActivatedKeys);
};
```

activatedë¥¼ ë°˜ì „í•˜ì—¬ í‘œì‹œ ìƒíƒœë¥¼ ë°”ê¾¸ê¸°ë¡œ í–ˆë‹¤.

### 3. ëœë¤ ì»¬ëŸ¬ ìƒì„±

ê¸°ì¡´ ì°¨íŠ¸ì˜ ì»¬ëŸ¬ë¥¼ ì“°ëŠ” ë°©ì‹ì€ ì´ëŸ¬í–ˆë‹¤.

```jsx
const colorSet = [
  "#4cc9f0",
  "#ffb703",
  "#06d6a0",
  "#560bad",
  "#d62828",
  "#f15bb5",
  "#4361ee",
  "#99d98c",
  "#5e548e",
  "#403d39",
];
```

ìƒ‰ 10ê°œê°€ ë“¤ì–´ìˆëŠ” ì»¬ëŸ¬ì…‹ì—ì„œ ì¼ë‹¤.

ì‚¬ì‹¤ ê·¸ëƒ¥â€¦ í‚¤ê°€ 10ê°œê°€ ë„˜ì§€ ì•Šì„ê±°ë¼ëŠ” ê°€ì •í•˜ì— ìƒê°í•œ ê²ƒì´ì—ˆë‹¤. ì™œëƒí•˜ë©´ ëœë¤ ì»¬ëŸ¬ë¡œ ì§€ì •í•˜ëŠ” ê²½ìš° í°ìƒ‰ì´ ë‚˜ì˜¤ê±°ë‚˜ ë³´ê¸° ë¶ˆí¸í•œ ìƒ‰ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨ì´ì—ˆë‹¤.

í‚¤ê°€ ë§ì„ ê²½ìš°ë¥¼ ê³ ë ¤í•˜ì—¬ ë‹¤ì‹œ ëœë¤ ì»¬ëŸ¬ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œë¥¼ ì‚¬ìš©í–ˆë‹¤.

```jsx
function randomColorGenerator() {
  let color = "#";

  for (let i = 0; i < 3; i++) {
    color += Math.floor(Math.random() * 127 + 128).toString(16);
  }

  return color;
}
```

ì¼ë‹¨ ì´ë ‡ê²Œ ì‘ì„±í•˜ì—¬ ë„ˆë¬´ ì–´ë‘ìš´ ìƒ‰ì´ ì•ˆ ë‚˜ì˜¤ë„ë¡ í–ˆëŠ”ë° ë„ˆë¬´ ë°ì€ ìƒ‰ì´ ë‚˜ì™€ì„œ ë³´ê¸° í˜ë“¤ ê²½ìš°ê°€ í•´ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ì‹œ ê³ ì³ì•¼ í•  ê²ƒ ê°™ë‹¤.

### ChatGPTì˜ ì½”ë“œë¦¬ë·°

1. `makeData` í•¨ìˆ˜ë¥¼ ë” ê°„ê²°í•˜ê²Œ ì‘ì„±í•  ê²ƒ
2. `randomColorGenerator` \*\*\*\*í•¨ìˆ˜ë¥¼ ê³ ì¹  ê²ƒ
   1. â€œë°˜í™˜ëœ ì»¬ëŸ¬ê°€ í°ìƒ‰ì¸ ê²½ìš° í…ìŠ¤íŠ¸ ìƒ‰ìƒê³¼ ì¶©ëŒí•˜ì—¬ ë²„íŠ¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì•Œì•„ë³´ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.â€
3. `handleKeys` í•¨ìˆ˜ë¥¼ ë” ê°„ê²°í•˜ê²Œ ì‘ì„±í•  ê²ƒ
4. `handleChartMode` í•¨ìˆ˜ - êµ³ì´ ë³€ìˆ˜ ì“°ì§€ ì•Šê¸°
5. ê³µí†µ ìŠ¤íƒ€ì¼ì„ CSS í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ ì¬ì‚¬ìš©í•˜ê¸°

---

## 23.04.10

### 1. ì½”ë“œ ë¦¬ë·°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œ ê³ ì¹˜ê¸°

- randomColorGenerator í•¨ìˆ˜

```jsx
function randomColorGenerator() {
  let color = "#";

  for (let i = 0; i < 3; i++) {
    color += Math.floor(Math.random() * 127 + 128).toString(16);
  }

  return color;
}
```

ì´ ì½”ë“œì˜ ë¬¸ì œì ì€ ë„ˆë¬´ ë°ì€ ìƒ‰ì„ ìƒì„±í•´ë‚¼ ìˆ˜ ìˆê³  ë¹„ìŠ·í•œ ìƒ‰ì„ ìƒì„±í•  í™•ë¥ ì´ ë†’ë‹¤ëŠ” ê²ƒì´ë‹¤.

ì¡°ê¸ˆ ë” ë‹¤ì–‘í•œ ìƒ‰ì„ ìƒì„±í•´ë‚¼ ìˆ˜ ìˆë„ë¡ HSL ë°©ì‹ì„ ì´ìš©í•˜ì˜€ë‹¤.

```jsx
function randomColorGenerator() {
  const hue = Math.floor(Math.random() * 360);
  const saturation = Math.floor(Math.random() * 100);
  const lightness = Math.floor(Math.random() * 20 + 50);
  return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
}
```

ì—¬ê¸°ì„œë„ ë„ˆë¬´ ë°ì€ ìƒ‰ì„ ìƒì„±í•˜ì§€ ì•Šë„ë¡ lightness ê°’ì„ ì¡°ì ˆí•˜ì˜€ë‹¤.

- handleKeys â†’ toggleActivation

í•¨ìˆ˜ì˜ ì—­í• ì„ ë” ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆë„ë¡ í•¨ìˆ˜ ì´ë¦„ì„ ë°”ê¿¨ë‹¤.

```jsx
const handleKeys = index => {
  const newChartData = [...chartData];
  newChartData[index] = {
    ...newChartData[index],
    activated: !newChartData[index].activated,
  };
  const newActivatedKeys = newChartData.filter(chartKey => chartKey.activated);
  setChartData(newChartData);
  setActiveKeys(newActivatedKeys);
};
```

ìœ„ ì½”ë“œë¥¼

```jsx
const toggleActivation = index => {
  const updatedChartData = chartData.map((data, i) => {
    if (i !== index) return data;
    return {
      ...data,
      activated: !data.activated,
    };
  });

  const activatedKeys = updatedChartData.filter(data => data.activated);

  setChartData(updatedChartData);
  setActiveKeys(activatedKeys);
};
```

ì´ë ‡ê²Œ ê³ ì³¤ë‹¤. ê·¸ëŸ°ë° ì‚¬ì‹¤ ê³ ì³ì•¼ë§Œí•˜ëŠ” ì´ìœ ëŠ” ì˜ ëª¨ë¥´ê² ë‹¤. ë‹¤ì‹œ ì½”ë“œë¦¬ë·°ë¥¼ ì‹œí‚¤ë‹ˆê¹Œ ì´ì „ ì½”ë“œ í˜•ì‹ìœ¼ë¡œ ë°”ê¾¸ë¼ê³  í•˜ê¸°ë„ í–ˆë‹¤..ğŸ˜…

### 2. PapaParse ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ csv íŒŒì¼ íŒŒì‹±

```jsx
function readFile(e) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = function () {
      const data = Papa.parse(reader.result, {
        header: true, // ì²« ë²ˆì§¸ í–‰ì„ í—¤ë”ë¡œ ì‚¬ìš©
        dynamicTyping: true, // ìˆ«ì ìë™ ë³€í™˜
        encoding: "EUC-KR", // ì¸ì½”ë”© ì„¤ì •
      }).data;

      resolve(data);
    };
    reader.onerror = reject;
    reader.readAsText(e.target.files[0], "EUC-KR");
  });
}
```

PapaParse ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ê¸°ì¡´ì˜ makeData í•¨ìˆ˜ê°€ í•´ì£¼ë˜ ì¼ì„ í•´ì¤€ë‹¤.

ë”°ë¼ì„œ DataView, DataChart ì»´í¬ë„ŒíŠ¸ë„ ê·¸ì— ë§ê²Œ ë³€ê²½í•´ì£¼ì—ˆë‹¤. makeData í•¨ìˆ˜ëŠ” ì œê±°í–ˆë‹¤.

[ì½”ë“œ](https://github.com/LifeIsAlone/DataVisualize/commit/1bce0af3e33bef0ec9e05a9c491b5211e18f2424)

### 3. ì°¨íŠ¸ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

`dom-to-image` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨íŠ¸ì˜ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í–ˆë‹¤.

![my-chart-image.jpeg](./images/my-chart-image.jpeg)

```jsx
const saveChartImage = () => {
  domtoimage
    .toJpeg(document.querySelector(".recharts-wrapper"))
    .then(function (dataUrl) {
      const link = document.createElement("a");
      link.download = "my-chart-image.jpeg";
      link.href = dataUrl;
      link.click();
    })
    .catch(function (error) {
      console.error("oops, something went wrong!", error);
    });
};
```

### ë°œê²¬í•œ ë²„ê·¸

- csv íŒŒì‹± ì¤‘ ë§ˆì§€ë§‰ì— null ìš”ì†Œê°€ ë“¤ì–´ê°€ëŠ” ë¬¸ì œ â†’ csv íŒŒì¼ì˜ ë§ˆì§€ë§‰ ì¤„ì— CRLFê°€ ìˆëŠ” ê²½ìš°ì¸ ë“¯ í•¨
  - FileReaderë¡œ íŒŒì¼ì„ ì½ê³  trim() í•¨ìˆ˜ë¥¼ ëŒë ¤ í•´ê²°
- ì°¨íŠ¸ ì´ë¯¸ì§€ ì €ì¥ ì‹œ ë°°ê²½ìƒ‰ â†’ option `bgColor`ë¡œ ì¡°ì •

### ë‹¤ìŒì— í•  ê²ƒ

- ì €ì¥ ë²„íŠ¼ ì˜®ê¸°ê¸°
- ë°˜ì‘í˜• êµ¬í˜„í•˜ê¸°

---

## 23.04.14

### 1. ì €ì¥ ë²„íŠ¼ ì˜®ê¸°ê¸°

![Untitled](./images/dv1.png)

ì´ë¯¸ì§€ ì €ì¥ ë²„íŠ¼ì„ ì°¨íŠ¸ ì•„ë˜ë¡œ ì˜®ê¹€

### 2. ì°¨íŠ¸ ì´ë¯¸ì§€ ì €ì¥ ì‹œ ë°°ê²½ìƒ‰ ë³€ê²½

![my-chart-image.jpeg](./images/my-chart-image.jpeg)

ì´ë¯¸ì§€ ì•„ë˜ì— ê²€ì€ìƒ‰ ì¤„ì´ ìƒê¹€

- ìº¡ì³ ì˜µì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì—˜ë¦¬ë¨¼íŠ¸ì˜ css ìŠ¤íƒ€ì¼ì„ ë³€ê²½í–ˆë”ë‹ˆ ìƒê¸´ ë¬¸ì œ

```jsx
const saveChartImage = () => {
  domtoimage
    .toJpeg(document.querySelector(".recharts-wrapper"), { bgcolor: "white" })
    .then(function (dataUrl) {
      const link = document.createElement("a");
      link.download = "my-chart-image.jpeg";
      link.href = dataUrl;
      link.click();
    })
    .catch(function (error) {
      console.error("oops, something went wrong!", error);
    });
};
```

`{ bgcolor: 'white' }`ë¥¼ ì´ìš©í•˜ì—¬ ìˆ˜ì •

- ë³€ê²½ ê²°ê³¼
  ![my-chart-image.jpeg](./images/my-chart-image1.jpeg)

docsë¥¼ ì˜ í™•ì¸í•˜ìâ€¦

### 3. ë°˜ì‘í˜• ë””ìì¸ìœ¼ë¡œ ë°”ê¾¸ê¸°

- pc & tablet

![Untitled](./images/dv2.png)

- phone

![Untitled](./images/dv3.png)

ê¸°ì¡´ì˜ ì½”ë“œëŠ” ë””ë°”ì´ìŠ¤ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì€ ì½”ë“œì˜€ë‹¤.

ì´ë¥¼ ë°˜ì‘í˜•ìœ¼ë¡œ ë°”ê¾¸ì—ˆë‹¤.

[ì½”ë“œ](https://github.com/LifeIsAlone/DataVisualize/commit/742bf3fc61494c8709a07f044b22dac1f4238528)

### 4. ìº¡ì³ ì˜µì…˜ ë³€ê²½

```jsx
const saveChartImage = () => {
  const element = document.querySelector(".recharts-wrapper");

  // í•­ìƒ 1500px widthë¡œ ìº¡ì³í•˜ê¸° ìœ„í•¨
  const width = 1500;
  const ratio = width / element.clientWidth;

  domtoimage
    .toJpeg(element, {
      bgcolor: "white",
      width: element.clientWidth * ratio,
      height: element.clientHeight * ratio,
      style: { transform: `scale(${ratio})`, "transform-origin": "top left" },
    })
    .then(function (dataUrl) {
      const link = document.createElement("a");
      link.download = "my-chart-image.jpeg";
      link.href = dataUrl;
      link.click();
    })
    .catch(function (error) {
      console.error("oops, something went wrong!", error);
    });
};
```

í•­ìƒ ì´ë¯¸ì§€ë¥¼ 1500pxì˜ ê°€ë¡œ í¬ê¸°ë¡œ ì €ì¥í•˜ë„ë¡ ì„¤ì •

ëª¨ë°”ì¼ì—ì„œëŠ” ìœ ìš©í•˜ì§€ ì•Šì„ ë“¯í•˜ë‹¤â€¦ ì™œëƒí•˜ë©´ ì°¨íŠ¸ê°€ ë„ˆë¬´ ì‘ì•„ì ¸ì„œ xì¶• ìš”ì†Œë“¤ì´ ìƒëµë˜ê¸° ë•Œë¬¸

![my-chart-image.jpeg](./images/my-chart-image2.jpeg)

ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤ì—ì„œ ì°¨íŠ¸ì— ë¹„í•´ ê¸€ì”¨ê°€ ë„ˆë¬´ í¬ë‹¤.
